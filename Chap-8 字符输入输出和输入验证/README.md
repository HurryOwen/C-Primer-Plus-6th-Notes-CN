### 缓冲区

为什么要有缓冲区？首先，把若干字符作为一个块进行传输比逐个发送这些字符节约时间。其次，如果用户打错字符，可以直接通过键盘修正错误。当最后按下 Enter 键时，传输的是正确的输入。

虽然缓冲输入好处很多，但是某些交互式程序需要无缓冲输入。

缓冲分为两类：**完全缓冲 I/O 行为和行缓冲 I/O。**

- 完全缓冲 I/O 输入指的是，当缓冲区被填满时才刷新缓冲区，通常出现在文件输入中。缓冲区的大小取决于系统，常见的大小是 512 字节和 4096 字节。
- 行缓冲 I/O 指的是，在出现换行符时刷新缓冲区。键盘输入通常是行缓冲输入，所以在按下 Enter 键后才刷新缓冲区。

### 结束键盘输入

##### 1、文件、流和键盘输入

**文件（file）**是存储器中存储信息的区域。
从概念上看，C 程序处理的是流而不是直接处理文件。
**流(stream)**是一个实际输入和输出映射的理想化数字流。这意味着，不同属性和不同种类的输入，由属性更统一的流来表示。于是，打开文件的过程，就是把流与文件相关联，而且读写都通过流来完成。
**要着重理解的是：**C 把输入和输出设备视为存储设备上的普通文件，尤其把键盘和显示设备视为每个 C 程序自动打开的文件。stdin 流表示键盘输入，stdout 流表示屏幕输出。

于是，我们可以用处理文件的方式来处理键盘输入。

##### 2、文件结尾

检测文件结尾有两种方法：

- 在文件末尾放一个特殊的字符标记文件结尾
- 储存文件大小的信息。

无论操作系统使用何种方式检测文件结尾，在 C 语言中，用`getchar()`读取文件检测到文件结尾时将返回一个特殊的值，即 EOF（end of file）。

通常 EOF 定义在 stdio.h 文件中，`#define EOF(-1)`，即 EOF 值为-1。

### 重定向和文件

输入和输出涉及函数、数据和设备。

重定向输入让程序使用文件而不是键盘来输入，重定向输出让程序输出至文件而不是屏幕。

### 创建更友好的用户界面

##### 1、使用缓冲输入

##### 2、混合数值和字符输入

`getchar()`读取每个字符，包括空格、制表符和换行符；而`scanf()`在读取数字时则会跳过空格、制表符和换行符

##### 3、输入验证

程序通常接受特殊形式的输入。可以在设计程序时考虑用户在输入时可能犯的错误，在输入验证部分处理这些错误情况，让程序更强健更友好

处理验证有多种方案，例如，如果用户输入错误类型的信息，可以终止程序，也可以给用户提供有限次或无限次机会重新输入。
